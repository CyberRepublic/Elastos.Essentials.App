<ion-content>
  <app-titlebar></app-titlebar>
  <ion-grid class="container" [class.darkContainer]="theme.darkMode" *ngIf="credential">
    <ion-row>
      <div class="icon-section" *ngIf="!isAvatarCred() && !isApp()">
        <img [src]="getCredIconSrc()">
      </div>
      <div class="icon-section" *ngIf="isApp()">
        <img *ngIf="isApp() && this.appIcon" [src]="this.appIcon" />
      </div>
      <div class="avatar-section" *ngIf="isAvatarCred()">
        <img [src]="getAvatar()" />
      </div>
    </ion-row>

    <ion-row class="details-section">
      <ion-col size="12">
        <div>
          <ion-label class="title">{{ getDisplayableCredentialTitle() }}</ion-label>
        </div>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="10.5">
        <ion-label class="value" *ngFor="let prop of displayableProperties()">{{ prop.value | translate }}</ion-label>
      </ion-col>
      <!-- <ion-col size="1.5">
        <img class="edit" src="{{ this.theme.darkMode ? '/assets/identity/svg/edit-dark.svg' : '/assets/identity/svg/edit.svg' }}"
          (click)="profileService.editProfile()" />
      </ion-col> -->
      <ion-col size="1.5">
        <img class="share" src="{{ this.theme.darkMode ? '/assets/identity/svg/share-dark.svg' : '/assets/identity/svg/share.svg' }}"
          (click)="profileService.shareIdentity()" />
      </ion-col>
    </ion-row>

    <ion-row class="credentials-section">
      <ion-grid>
        <ion-row *ngIf="!isPublished">
          <ion-col size="1.5" class="text-badge">
            <img class="published" src="../../../assets/identity/svg/publish-gray.svg" />
          </ion-col>
          <ion-col size="10.5">
            <span>{{ 'credential-not-published' |  translate }}</span>
          </ion-col>
        </ion-row>
        <ion-row *ngIf="isPublished">
          <ion-col size="1.5" class="text-badge">
            <img class="published" src="../../../assets/identity/svg/credential-published.svg" />
          </ion-col>
          <ion-col size="10.5">
            <span>{{ 'credential-published-on-blockchain' |  translate }}</span>
          </ion-col>
        </ion-row>
        <ion-row *ngIf="isVerified()">
          <ion-col size="1.5" class="text-badge">
            <img class="verified" src="../../../assets/identity/svg/verified-green.svg" />
          </ion-col>
          <ion-col size="10.5">
            <span>{{ 'credential-verified' |  translate }}</span>
          </ion-col>
        </ion-row>
        <ion-row
          *ngIf="!isVerified() && !this.credential.pluginVerifiableCredential.getSubject().hasOwnProperty('apppackage')">
          <ion-col size="1.5" class="text-badge">
            <img class="verified" src="../../../assets/identity/svg/verified-gray.svg" />
          </ion-col>
          <ion-col size="10.5">
            <span>{{ 'credential-unverified' |  translate}}</span>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-row>

    <ion-row class="actions-section">
      <span class="title">{{ 'current-actions' |  translate }}</span>
      <div *ngIf="(!isPublished && !this.credential.pluginVerifiableCredential.getSubject().hasOwnProperty('apppackage'))" class="card-action-alert" (click)="publishCredential()">
        <div class="icon">
          <img src="../../../assets/identity/svg/circle-with-plus.svg" />
        </div>
        <div class="text">
          <span class="title">{{ 'credential-not-published' |  translate }}</span>
          <span class="description">{{ 'credential-on-blockchain' |  translate }}</span>
        </div>
        <div class="chevron">
          <img src="../../../assets/identity/svg/chevron-thin-right-dark.svg" />
        </div>
      </div>
      <div class="card-action-validate"
        *ngIf="!this.credential.pluginVerifiableCredential.getSubject().hasOwnProperty('apppackage')"
        (click)="verifyCredential()">
        <div class="icon">
          <img src="../../../assets/identity/svg/verified-white.svg" />
        </div>
        <div class="text">
          <span *ngIf="!isVerified()" class="title">{{ 'verify-credential' |  translate }}</span>
          <span *ngIf="isVerified()" class="title">{{ 'reverify-credential' |  translate }}</span>
          <span class="description">{{ 'launch-external-app-to-verify' |  translate }}</span>
        </div>

        <div class="chevron">
          <img src="../../../assets/identity/svg/chevron-thin-right-dark.svg" />
        </div>
      </div>
    </ion-row>

    <ion-row class="issuer-section" *ngIf="issuer && isVerified()">
      <ion-segment value="validator" (ionChange)="issuerSegmentChanged($event)">
        <ion-segment-button value="validator">
          <ion-label>{{ 'validator' |  translate }}</ion-label>
        </ion-segment-button>
        <ion-segment-button value="history">
          <ion-label>{{ 'history' |  translate }}</ion-label>
        </ion-segment-button>
      </ion-segment>

      <div class="issuer-validator" *ngIf="segment == 'validator'">
        <div class="card-icon">
          <img *ngIf="issuer.avatar == ''" [src]="getSmallIcon('name')" />
          <div *ngIf="issuer.avatar !== ''">
            <img [src]="issuer.avatar" />
          </div>
        </div>
        <div class="card-internal">
          <!-- <img class="card-issuer-chevron" src="../../../assets/identity/svg/chevron-thin-right-black.svg" /> -->
          <span *ngIf="hasIssuerName()" class="card-title">{{ issuer.name }}</span>
          <span *ngIf="!hasIssuerName()" class="card-title">{{ issuer.did }}</span>

          <span class="card-value">
            <ion-grid>
              <ion-row *ngIf="hasIssuerName()">
                <ion-col size="12">{{ issuer.did }}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="6">{{ 'issuance-date' |  translate }}</ion-col>
                <ion-col size="6">{{ getIssuanceDate() }}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="6">{{ 'expiration-date' |  translate }}</ion-col>
                <ion-col size="6">{{ getExpirationDate() }}</ion-col>
              </ion-row>
            </ion-grid>
          </span>
        </div>
      </div>
      <div class="issuer-history" *ngIf="segment == 'history'">
        <div class="text-badge-disabled">
          <img src="../../../assets/identity/svg/check-disabled.svg" />
          <span>&nbsp;{{ 'no-history-display' |  translate }}</span>
        </div>
      </div>
    </ion-row>
  </ion-grid>
</ion-content>
